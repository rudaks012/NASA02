<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.Nasa.prj.payment.service.PaymentMapper">
   <select id="buyerPaymentList" resultType="co.Nasa.prj.comm.VO.PaymentVO">
      SELECT *
      FROM PAYMENT
      WHERE B_EMAIL = #{b_email}
      ORDER BY PAY_DATE DESC
   </select>
   
   <select id="selectPagingBuyerPaymentList" resultType="co.Nasa.prj.comm.VO.PaymentVO">
   		SELECT	*
   		FROM	(
   				 SELECT	ROWNUM RN, A.*
   				 FROM	(
   				 		 SELECT 	*
   				 		 FROM 		PAYMENT
   				 		 WHERE 		B_EMAIL = #{b_email}
   				 		 ORDER BY	PAY_DATE DESC
   				 ) A
   		)
   		WHERE	RN BETWEEN #{start} AND #{end}
   </select>
   
   <select id="countPagingBuyerPayment" resultType="int">
   		SELECT	COUNT(*)
   		FROM	PAYMENT
   		WHERE	B_EMAIL = #{b_email}
   </select>
   
   <select id="monthSearch" resultType="co.Nasa.prj.comm.VO.PaymentVO">
   		SELECT	*
   		FROM	(
   				 SELECT ROWNUM RN, A.*
   				 FROM	(
   				 		 SELECT	*
   				 		 FROM		PAYMENT
   				 		 WHERE		B_EMAIL = #{b_email} AND PAY_DATE >= ADD_MONTH(sysdate, -1)
   				 		 ORDER BY	PAY_DATE DESC
   				 ) A
   		)
   		WHERE	RN BETWEEN #{start} AND #{end}
   </select>
   
   
   <!-- 차트 입력 -->
   <select id="selectListChart" resultType="co.Nasa.prj.comm.VO.PaymentVO">
      SELECT PAY_DATE,PAY_PRICE FROM PAYMENT
   </select>
   
   <!-- 테이블 입력할때 씀 -->
   <select id="selectpaymenttable" resultType="int" parameterType="int">
      SELECT NVL(SUM(PAY_PRICE),0)
      FROM PAYMENT
      WHERE SUBSTR(PAY_DATE,6,2) =#{num}
   </select>
   
   <select id="countservice" resultType="int" parameterType="int">
      SELECT COUNT(*) 
      FROM PAYMENT
      WHERE SUBSTR(PAY_DATE,6,2) =#{num}
   </select>
   
   <!-- 연도별 차트 입력 -->
   <select id="selectListYearChart" resultType="co.Nasa.prj.comm.VO.PaymentVO">
      SELECT PAY_DATE,PAY_PRICE FROM PAYMENT
   </select>
   
   <!-- 연도별 누적 판매금액,  수수료 -->
   <select id="selectYearchart" resultType="int" parameterType="int">
      SELECT NVL(SUM(PAY_PRICE),0)
       FROM PAYMENT
       WHERE SUBSTR(PAY_DATE,0,4) = #{num}
   </select>
   
   <!-- 연도별 누적 판매 수량 -->
   <select id="countYearChart" resultType="int" parameterType="int">
       SELECT COUNT(*)
          FROM PAYMENT
        WHERE SUBSTR(PAY_DATE,0,4) = #{num}
   </select>
   

	<!-- 채팅 결제 -->
	<insert id="insertchatpayment" parameterType="co.Nasa.prj.comm.VO.PaymentVO">
	
	</insert>
	
	<select id="sellerSalesData" resultType="co.Nasa.prj.comm.VO.PaymonthVO">
		SELECT 
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'01',pay_price,0)) AS  "january",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'02',pay_price,0)) AS  "february", 
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'03',pay_price,0)) AS  "march",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'04',pay_price,0)) AS  "april",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'05',pay_price,0)) AS  "may",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'06',pay_price,0)) AS  "june",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'07',pay_price,0)) AS  "july",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'08',pay_price,0)) AS  "august",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'09',pay_price,0)) AS  "september",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'10',pay_price,0)) AS  "october",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'11',pay_price,0)) AS  "november",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'12',pay_price,0)) AS  "december",
            SUM(1) AS MT
          FROM payment 
          WHERE  S_EMAIL= #{s_email} AND  SUBSTR(pay_enddate,0,4)= #{year}
          AND S_CODE = #{scode}
	</select>

	<select id="sellerCommData" resultType="co.Nasa.prj.comm.VO.PaymonthVO">
		 SELECT 
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'01',pay_originp*(pay_com/10),0)) AS  "january",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'02',pay_originp*(pay_com/10),0)) AS  "february", 
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'03',pay_originp*(pay_com/10),0)) AS  "march",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'04',pay_originp*(pay_com/10),0)) AS  "april",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'05',pay_originp*(pay_com/10),0)) AS  "may",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'06',pay_originp*(pay_com/10),0)) AS  "june",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'07',pay_originp*(pay_com/10),0)) AS  "july",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'08',pay_originp*(pay_com/10),0)) AS  "august",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'09',pay_originp*(pay_com/10),0)) AS  "september",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'10',pay_originp*(pay_com/10),0)) AS  "october",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'11',pay_originp*(pay_com/10),0)) AS  "november",
            SUM(DECODE(SUBSTR(pay_enddate,6,2),'12',pay_originp*(pay_com/10),0)) AS  "december",
            SUM(1) AS MT
          FROM payment 
          WHERE s_email= #{s_email} and  SUBSTR(pay_enddate,0,4)= #{year}
          AND S_CODE = #{scode}
	</select>
</mapper>