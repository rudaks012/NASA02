<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.Nasa.prj.powerservice.service.PowerServiceMapper">

	<select id="PowerServiceList" resultType="co.Nasa.prj.comm.VO.PowerServiceVO">
		SELECT * FROM V_POWER_LIST
	</select>
	
	<select id="endPower" resultType="String">
		<![CDATA[
		SELECT MAX(POWER_END) 
		FROM POWERSERVICE 
		WHERE SER_CODE = #{ser_code} 
		AND TO_CHAR(SYSDATE, 'YYYY-MM-DD') < POWER_END ]]>
	</select>
	
	<insert id="powerserviceInsert" parameterType="co.Nasa.prj.comm.VO.PowerServiceVO">
		INSERT INTO POWERSERVICE 
		VALUES((SELECT NVL(MAX(POWER_CODE),0)+1 FROM POWERSERVICE ), #{s_email}, 
		#{ser_code}, #{power_start}, to_date(#{power_start},'yyyy-mm-dd')+7, sysdate, #{power_price})
	</insert>
</mapper>