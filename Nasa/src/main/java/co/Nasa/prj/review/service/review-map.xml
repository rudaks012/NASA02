<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.Nasa.prj.review.service.ReviewMapper">
	<select id="buyerSelectReviewList" resultType="co.Nasa.prj.comm.VO.ReviewVO">
		SELECT		*
		FROM		REVIEW
		WHERE		REV_ID = #{rev_id}
		ORDER BY 	REV_CODE DESC
	</select>
	
	<select id="selectReview" resultType="co.Nasa.prj.comm.VO.ReviewVO">
		SELECT	*
		FROM	REVIEW
		WHERE	REV_CODE = #{rev_code}
	</select>
	
	<delete id="deleteReview" parameterType="co.Nasa.prj.comm.VO.ReviewVO">
		DELETE
		FROM 	REVIEW
		WHERE 	REV_CODE = #{rev_code}
	</delete>
	
	<insert id="insertReview" parameterType="co.Nasa.prj.comm.VO.ReviewVO">
		INSERT INTO REVIEW(REV_CODE, SCODE, REV_NAME, REV_SUB, REV_ID, REV_SER_NAME)
		VALUES (#{rev_code}
				, #{scode}
				, #{rev_name}
				, #{rev_sub}
				, #{rev_id}
				, #{rev_ser_name})
	</insert>
	
	<update id="updateReview" parameterType="co.Nasa.prj.comm.VO.ReviewVO">
		UPDATE	REVIEW
		SET		REV_SUB = #{rev_sub}, REV_RATE = #{rev_rate}, REV_IMG = #{rev_img}
		WHERE	REV_CODE = #{rev_code}
	</update>
	
	<select id="sellerReviewList" resultType="co.Nasa.prj.comm.VO.ReviewVO">
		SELECT m.* FROM SERVICE s ,
		(SELECT * FROM REVIEW r , REVIEW_COMMENT c WHERE REV_CODE = REVIEW_CODE(+) ORDER BY REV_DATE DESC) m
		WHERE s.s_email = #{s_email} and s.ser_code = scode
	</select>
	
	<select id="sellerReviewSelectList" resultType="co.Nasa.prj.comm.VO.ReviewVO">
		SELECT r.* 
		FROM REVIEW r, SERVICE s 
		WHERE S_EMAIL= #{s_email} AND SCODE = SER_CODE
		AND SCODE = #{scode}
		ORDER BY r.rev_date DESC
	</select>
	
	<select id="reviewSearch" resultType="co.Nasa.prj.comm.VO.ReviewVO">
		SELECT m.* FROM SERVICE s ,
		(SELECT * FROM REVIEW r , REVIEW_COMMENT c WHERE REV_CODE = REVIEW_CODE(+) ORDER BY REV_DATE DESC) m
		WHERE s.s_email = #{s_email} and s.ser_code = scode and scode = #{scode}
	</select>
	
	
</mapper>